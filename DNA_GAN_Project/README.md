# DNA Sequence Generation using GANs

This project implements and compares two different GAN architectures for generating synthetic DNA sequences:

1. **Gumbel-Softmax GAN**: A basic implementation using LSTM generators with the Gumbel-Softmax trick
2. **Improved WGAN-GP**: An advanced implementation using Wasserstein GAN with gradient penalty, LSTM generators with attention, and CNN discriminators with spectral normalization

## Project Structure

```
DNA_GAN_Project/
├── models/                    # Model implementations
│   ├── gumbel_softmax_gan/    # Original GAN implementation
│   └── improved_wgan/         # Improved WGAN-GP implementation
├── data/                      # Data files
│   ├── clean_all_dna_sequences.fasta    # Original DNA sequences
│   ├── gumbel_generated_sequences.fasta # Sequences generated by Gumbel-Softmax GAN
│   └── improved_generated_sequences.fasta # Sequences generated by Improved WGAN-GP
├── utils/                     # Utility functions
│   └── data_preparation.py    # Data preparation utilities
├── evaluation/                # Evaluation scripts and results
├── visualization/             # Visualization tools
│   └── streamlit_app.py       # Streamlit app for visualization
├── docs/                      # Documentation
│   ├── DNA_GAN_Research_Report.md  # Research report on the GAN implementations
│   └── HOW_TO_RUN_IMPROVED_GAN.md  # Instructions for running the improved GAN
├── run_streamlit_app.py       # Script to run the Streamlit app
└── README.md                  # This file
```

## Requirements

- Python 3.10
- PyTorch
- NumPy
- Matplotlib
- tqdm
- BioPython
- scikit-learn
- Streamlit (for visualization)

## Installation

1. Create a virtual environment with Python 3.10:
   ```bash
   python -m venv env310
   ```

2. Activate the virtual environment:
   ```bash
   # On Windows
   env310\Scripts\activate
   
   # On Unix or MacOS
   source env310/bin/activate
   ```

3. Install the required packages:
   ```bash
   pip install torch numpy matplotlib tqdm scikit-learn biopython streamlit
   ```

## Running the Models

### Gumbel-Softmax GAN

To train the Gumbel-Softmax GAN:

```bash
cd DNA_GAN_Project
python -m models.gumbel_softmax_gan.run_dna_gan --fasta_file data/clean_all_dna_sequences.fasta --num_epochs 1000
```

To resume training from a checkpoint:

```bash
python -m models.gumbel_softmax_gan.resume_training
```

To visualize training progress:

```bash
python -m models.gumbel_softmax_gan.visualize_training
```

### Improved WGAN-GP

To train the Improved WGAN-GP:

```bash
cd DNA_GAN_Project
python -m models.improved_wgan.run_improved_dna_gan --fasta_file data/clean_all_dna_sequences.fasta --num_epochs 500
```

To resume training from a checkpoint:

```bash
python -m models.improved_wgan.resume_training
```

To visualize training progress:

```bash
python -m models.improved_wgan.visualize_training
```

## Visualization with Streamlit

The project includes a Streamlit app for visualizing and comparing the original and generated DNA sequences.

To run the Streamlit app:

```bash
cd DNA_GAN_Project
python run_streamlit_app.py
```

If you don't have the necessary data files, you can generate dummy data for visualization:

```bash
python run_streamlit_app.py --prepare-data
```

The Streamlit app provides the following features:
- View original DNA sequences
- Explore generated sequences from both models
- Compare evaluation metrics
- Visualize training progress

## Model Comparison

The Improved WGAN-GP model offers several advantages over the Gumbel-Softmax GAN:

1. **More Stable Training**: The Wasserstein loss with gradient penalty provides more stable training, avoiding the mode collapse observed in the Gumbel-Softmax GAN.

2. **Better Diversity**: The generated sequences show higher diversity, as measured by both sequence diversity and k-mer diversity metrics.

3. **More Realistic GC Content**: The GC content of generated sequences is closer to that of real DNA sequences.

4. **Improved Spatial Patterns**: The Moran's I spatial autocorrelation of generated sequences is closer to that of real DNA sequences.

5. **Attention Mechanism**: The self-attention mechanism helps capture long-range dependencies in DNA sequences.

6. **Spectral Normalization**: Spectral normalization in the discriminator provides more stable gradients during training.

## Documentation

For more detailed information, please refer to the following documentation:

- [DNA GAN Research Report](docs/DNA_GAN_Research_Report.md): A comprehensive research report on the GAN implementations, including methodology, results, and analysis.
- [How to Run the Improved GAN](docs/HOW_TO_RUN_IMPROVED_GAN.md): Detailed instructions for running the improved WGAN-GP model.

## License

This project is licensed under the MIT License - see the LICENSE file for details.
